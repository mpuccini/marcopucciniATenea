<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>marcopuccini@enea/puccini/projects/eneamongodb/</title>
    
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="all,follow">
    <meta name="googlebot" content="index,follow,snippet,archive">
    <link rel="stylesheet" href="https://www.afs.enea.it/puccini/hugo-theme-console/css/terminal-0.7.1.min.css">
    <link rel="stylesheet" href="https://www.afs.enea.it/puccini/hugo-theme-console/css/animate-3.7.2.min.css">
    <link rel="stylesheet" href="https://www.afs.enea.it/puccini/hugo-theme-console/css/console.css">
    
      <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
      <![endif]-->
       <meta property="og:title" content="enea-mongodb" />
<meta property="og:description" content="" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.afs.enea.it/puccini/projects/eneamongodb/" /><meta property="article:published_time" content="2019-01-01T00:00:00+00:00" />



<meta name="twitter:title" content="enea-mongodb"/>
<meta name="twitter:description" content="ENEA mongoDB Among the big field of noSQL databases, mongoDB is the most widely used open source technology of his type, especially for Big Data storage and mnagment. ENEA start a collaboration with me to evaluate such technology and to build up a cluster installation of the Community Edition. Due to the common CAP theorem tradeoffs, mongoDB has a complex architecture to guarantee Consistency and (of course) Partition failures, with an high ratio of Accessibility too."/>

</head>
<body class="terminal">
    <div class="container">
        <div class="terminal-nav">
          <header class="terminal-logo">
            <div class="logo terminal-prompt">
              
              
              <a href="https://www.afs.enea.it/puccini/" class="no-style site-name">marcopuccini@enea</a>:~# 
              <a href='https://www.afs.enea.it/puccini/projects'>projects</a>/<a href='https://www.afs.enea.it/puccini/projects/eneamongodb'>eneamongodb</a>/</div></header>
          <nav class="terminal-menu">
            <ul vocab="https://schema.org/" typeof="BreadcrumbList">
                
                <li><a href="https://www.afs.enea.it/puccini/about/" typeof="ListItem">about/</a></li>
                
                <li><a href="https://www.afs.enea.it/puccini/projects/" typeof="ListItem">projects/</a></li>
                
                <li><a href="https://www.afs.enea.it/puccini/publications/" typeof="ListItem">publications/</a></li>
                
                <li><a href="https://www.afs.enea.it/puccini/contacts/" typeof="ListItem">contacts/</a></li>
                
                <li><a href="https://www.afs.enea.it/docs/puccini_eurocv.pdf" typeof="ListItem">resume/</a></li>
                
            </ul>
          </nav>
        </div>
    </div>

    <div class="container zoomIn fast" >
        
<h1>enea-mongodb</h1>
<h3 id="enea-mongodb">ENEA mongoDB</h3>
<p>Among the big field of noSQL databases, mongoDB is the most widely used open source technology of his type, especially for Big Data storage and mnagment. ENEA start a collaboration with me to evaluate such technology and to build up a cluster installation of the Community Edition. Due to the common CAP theorem tradeoffs, mongoDB has a complex architecture to guarantee Consistency and (of course) Partition failures, with an high ratio of Accessibility too. This architecture consists of 3 logical entities:</p>
<ul>
<li>Shard</li>
<li>Config Server</li>
<li>Router</li>
</ul>
<p>A <strong>Shard</strong> is where data are stored and its name came from the sharding function that it perform. The sharding is the operation to divide data into smallest parts that being distributed to many Shards. Every part of fragmented data has an identification key, so it is possibile to rebuild the entire data once is querried. This allow the system to scale horizzontally that is the ability to raise performances adding more hosts (physical or virtual) instead of upgrading each single host hardware.<br>
The <strong>Config Server</strong> is the one who take all the cluster infos, such as the shards keys, the operations of data and more.<br>
The <strong>Router</strong> is the one who routes the traffic within the cluster, so if you need to query the DB, you must interact with him.<br>
To allow data redundancy, the shards and the config server must run on (2n+1) hosts each, so all the information that they have, can be replicated in a consistent way, due to the rules of Consensus in case of partition failures. For this reason, the minimum number of hosts that a shard and/or a Config server need to installed on is 3. This set of hosts is named Replica Set. So you need to build both the Shards and the Config Servers on Replica Sets. In each Replica Set there are roles:</p>
<ul>
<li>Primary: the first to receive i/o operations</li>
<li>Secondary: where data replications are copied asynchronously</li>
<li>Arbiter: partecipate on electing new Primary in case of failures, but does not hold data.</li>
</ul>
<p>The ENEA cluster is builded on 4 physical machine with this locagical sheme:<br>
FIGURE<br>
where there are 3 hosts that serves 1 Shard and 1 Config Server, and 1 hosts for the Router according to this schema for hostname roles (showed in a yaml way):</p>
<pre><code class="language-yaml																				" data-lang="yaml																				">	- cresco-mgdb01
	- cresco-mgdb02
	- cresco-mgdb03
routers:
	- cresco-mgdb04														
shards:
	sh0:
		- cresco-mgdb03
		- cresco-mgdb02
		- cresco-mgdb01																 
ports:														routers: 27017									
       shards: 27018										
       cfgRS: 27019
</code></pre><p>This schema shows also the ports where instances talks with. To access the mongoDB you need the proper authorizations.</p>
<blockquote>
<p>As you can see from the architecture schema, you might think it&rsquo;s useless to have only one shard. Indeed this is a Development configuration according to mongoDB manual too. This is due to the extraordinary occurrence of Covid-19 pandemic explosion concurrent to the cluster setup. So other hosts they were expected to serve the mongoDB cluster are not installed in time. Despite this, the architecture is ready at anytime to be expanded with new shards as soon is it will be possible again.</p>
</blockquote>


        <div class="footer">
    Powered by <a href="https://gohugo.io/">Hugo</a> with
    <a href="https://github.com/mrmierzejewski/hugo-theme-console/">Console Theme</a>. 
</div>

    </div>
  </body>
</html>
